<ul class="page-breadcrumb breadcrumb">
    <li>
        <a href="index.html">MultiTex ERP</a>

    </li>
    <li>
        <a href="#">Cutting</a>

    </li>
    <li>
        <a href="#" ng-bind="vm.Title"></a>
    </li>
</ul>

<div class="portlet box blue-dark">
    <div class="portlet-title">
        <div class="caption">
            {{vm.Title}}
        </div>
        <div class="tools">
        </div>

        <div class="actions">
        </div>
    </div>

    <div class="portlet-body">
        <table class="table table-condensed table-striped table-bordered" style="padding-left: 5px; padding-right: 5px; margin-bottom: 3px;">
            <tbody>
                <tr>
                    <td style="width: 30%; padding-bottom: 0px; padding-bottom: 0px;">

                        <form name="CutPanelStoreRecvForm" ng-submit="vm.submitData(BARCODE, CutPanelStoreRecvForm.$valid)">

                            <div class="form-group" ng-class="{'has-error': CutPanelStoreRecvForm.$invalid }">
                                <input type="text" class="form-control" ng-model="BARCODE" autocomplete="off" name="BARCODE" style="height:28px;" focus-me="true" placeholder="Bundle Card" ng-maxlength="18" ng-minlength="18">


                                <button type="submit"  style="display:none;"></button>
                            </div>
                        </form>
                    </td>


                    <td style="width: 30%;  border-left: hidden; padding-bottom: 0px;">

                        <div class="help-block" style="background-color: red; font-size: 13px; color: white; padding: 5px; " ng-if="vm.errors">
                            <b>{{vm.errors}}</b>
                        </div>

                        <div class="help-block" style="background-color: red; font-size: 13px; color: white; padding: 5px;"
                             ng-if="!vm.errors &&  CutPanelStoreRecvForm.BARCODE.$dirty && (CutPanelStoreRecvForm.BARCODE.$error.invalid_barcode||CutPanelStoreRecvForm.BARCODE.$error.maxlength||CutPanelStoreRecvForm.BARCODE.$error.minlength)">
                            <b>Invalid Barcode</b>
                        </div>

                    </td>



                    <td style="width: 15%; text-align: right; border-left: hidden; padding-bottom: 0px;">
                        <h4 class="block" style="margin:0px;">
                            <span class="label label-primary">
                                <b>{{vm.ttlBundleScanned}}</b>
                            </span>
                            Bundles Scaned
                        </h4>
                    </td>

                    <td style="width: 15%; text-align: right; border-left: hidden; padding-bottom: 0px;">
                        <h4 class="block" style="margin:0px;">
                            Total Quantity
                            <span class="label label-primary">
                                <b>{{vm.ttlQtyScanned}}</b>
                            </span>
                        </h4>

                    </td>

                    <td style="width: 10%; text-align: right; border-left: hidden; padding-bottom: 0px;">
                        <h4 class="block" style="margin:0px;">
                            <a class="btn btn-xs purple-intense" ng-click="vm.openStoreRecvOpt()" ng-disabled="vm.ttlBundleScanned == 0">
                                <i class="fa fa-list-alt"></i> Take Action
                            </a>
                        </h4>

                    </td>


                </tr>
            </tbody>
        </table>



        <fieldset class="custom-fieldset" style="padding-top: 0px;padding-bottom: 0px;" ng-if="vm.LastBundle.GMT_CUT_PNL_BNK_ID > 0">
            <legend class="custom-legend">Last Scanned Bundle(Scan)</legend>
            <table class="table table-condensed table-striped table-bordered" style="padding:5px;">
                <tbody>
                    <tr>
                        <td style="width:8%" colspan="2">
                            <b>Buyer</b>
                        </td>

                        <td style="width: 8%">
                            {{vm.LastBundle.BYR_ACC_GRP_NAME_EN}}
                        </td>

                        <td style="width: 16%" colspan="2">
                            <b>Style</b>
                        </td>

                        <td style="width:16%" colspan="2">
                            {{vm.LastBundle.WORK_STYLE_NO}}
                        </td>

                        <td style="width: 8%">
                            <b>Order</b>
                        </td>


                        <td style="width: 8%">
                            {{vm.LastBundle.ORDER_NO}}
                        </td>
                        <td style="width: 4%">
                            <b>Item</b>
                        </td>

                        <td style="width: 12%" colspan="2">
                            {{vm.LastBundle.ITEM_NAME_EN}}
                        </td>


                        <td style="width: 4%">
                            Cntry
                        </td>

                        <td style="width: 4%">
                            {{vm.LastBundle.COUNTRY_NAME_EN}}
                        </td>



                    </tr>

                    <tr>

                        <td style="width: 8%">
                            <b>Color</b>
                        </td>

                        <td style="width:16%" colspan="2">
                            {{vm.LastBundle.COLOR_NAME_EN}}
                        </td>
                        <td style="width:5%;color:red;">
                            <b>CutNo</b>
                        </td>

                        <td style="width:5%">
                            {{vm.LastBundle.CUTNG_NO}}
                        </td>


                        <td style="width: 5%; color: red; ">
                            <b>Size</b>
                        </td>


                        <td style="width:8%">
                            {{vm.LastBundle.SIZE_CODE}}
                        </td>
                        <td style="width: 8%; color: red;">
                            <b>Bundle No</b>
                        </td>


                        <td style="width:8%">
                            {{vm.LastBundle.BUNDLE_NO}}
                        </td>

                        <td style="width: 4%; color: red;">
                            <b>Serial</b>
                        </td>

                        <td style="width: 12%;" colspan="2">
                            {{vm.LastBundle.SL_RANGE_TXT}}
                        </td>


                        <td style="width: 8%; color: red;">
                            <b>Quantity</b>

                        </td>


                        <td style="width: 8%">
                            {{vm.LastBundle.QTY_IN_BNDL}}
                        </td>


                    </tr>
                    <tr>
                        <td colspan="14" align="center">
                            <a class="btn btn-xs btn-block btn-default" ng-click="vm.RemoveFromScannedList(vm.LastBundle.GMT_CUT_PNL_BNK_ID)" style="width:50%;">
                                <i class="fa fa-times"></i> Remove
                            </a>
                        </td>
                    </tr>
                </tbody>
            </table>

        </fieldset>
        <fieldset class="custom-fieldset" style="padding-top: 0px;padding-bottom: 5px;" ng-repeat="item in vm.summaryData">
            <legend class="custom-legend">Data Summary</legend>

            <table class="table table-condensed table-striped table-bordered" style="padding:5px;">

                <thead>
                    <tr style="font-size:15px;font-weight:900;">
                        <th colspan="11" style="color:darkorange;">
                            Buyer: {{item.BYR_ACC_GRP_NAME_EN}}>> Style: {{item.STYLE_NO}}>> Order: {{item.ORDER_NO}}>> Color: {{item.COLOR_NAME_EN}}>>Cutting No: {{item.CUTNG_NO}}

                           &nbsp;&nbsp;&nbsp; <label class="label label-danger" style="cursor:pointer;" ng-click="vm.RemoveFromScannedList(item.GMT_CUT_PNL_BNK_LST)">
                                <i class="fa fa-times"></i>Remove
                            </label>
                        </th>
                        <th style="text-align: right; border-left: hidden;">
                            <a class="btn btn-xs btn-info" ng-click="vm.openBundleStatusModal(item)">
                                Bundle Movement Status
                            </a>

                        </th>

                    </tr>

                    <tr class="site-table-header">
                        <th style="width:20%;" rowspan="2">
                            <small>
                                Item
                            </small>

                        </th>

                        <th style="width:10%;" rowspan="2">
                            <small>
                                Country
                            </small>

                        </th>

                        <th style="width:10%;" rowspan="2">
                            <small>
                                Size
                            </small>

                        </th>

                        <th style="width:10%;" rowspan="2">
                            <small>
                                Cutting Qty
                            </small>

                        </th>

                        <th style="width: 20%; border: 1px solid #cecece;text-align:center;" colspan="4">
                            <small>
                                 # of Bundles- Status
                            </small>

                        </th>

                        <th style="width: 20%; border: 1px solid #cecece;text-align:center;" colspan="4">
                            <small>
                                Current Bundle Status
                            </small>

                        </th>



                    </tr>
                    <tr class="site-table-header">
                        <th style="width:5%;">
                            <small>
                                Cutting
                            </small>

                        </th>

                        <th style="width:5%;">
                            <small>
                                QC Passed
                            </small>

                        </th>

                        <th style="width:5%;">
                            <small>
                                Store Recv
                            </small>

                        </th>

                        <th style="width:5%;">
                            <small>
                               Pending2Recv
                            </small>

                        </th>

                        <th style="width:5%;">
                            <small>
                                Scanned
                            </small>

                        </th>


                        <th style="width:5%;">
                            <small>
                                Cut Qty
                            </small>

                        </th>

                        <th style="width:5%;">
                            <small>
                                +/- Qty
                            </small>

                        </th>

                        <th style="width:5%;">
                            <small>
                                Recv Qty
                            </small>

                        </th>

                    </tr>

                </thead>

                <tbody>
                    <tr ng-repeat="itm in item.details">
                        <td rowspan="{{itm.ITEM_SPAN}}" ng-if="itm.ITEM_SL==1">
                            {{itm.ITEM_NAME_EN}}
                        </td>

                        <td rowspan="{{itm.COUNTRY_SPAN}}" ng-if="itm.COUNTRY_SL==1">
                            {{itm.COUNTRY_NAME_EN}}
                        </td>

                        <td>
                            {{itm.SIZE_CODE}}
                        </td>

                        <td>
                            {{itm.CUTTING_QTY}}
                        </td>

                        <td>
                            {{itm.NO_OF_BNDL_CUTTING}}
                        </td>

                        <td>
                            {{itm.NO_OF_BNDL_INSPECTED}}
                        </td>

                        <td>
                            {{itm.NO_OF_BNDL_STORE_RECV}}
                        </td>


                        <td ng-class="{'danger': (itm.NO_OF_BNDL_CUTTING - itm.NO_OF_BNDL_STORE_RECV) > 0 }">
                            <b> {{ itm.NO_OF_BNDL_CUTTING - itm.NO_OF_BNDL_STORE_RECV }} </b> 
                        </td>


                        <td>
                            {{itm.NO_OF_BNDL_SCANNED}}
                        </td>


                        <td>
                            {{itm.CUTTING_QTY_CUR}}
                        </td>
                        <td>
                            {{itm.SHORT_QTY}}
                        </td>
                        <td>
                            {{itm.FINAL_QTY}}
                        </td>
                    </tr>
                </tbody>
                <tfoot>
                    <tr>
                        <td colspan="3" style="text-align:right;">
                            <b>Total</b>
                        </td>
                        <td>
                            <b>{{item.TTL_CUTTING_QTY}}</b>

                        </td>

                        <td>
                            <b>{{item.TTL_NO_OF_BNDL_CUTTING}}</b>
                            
                        </td>

                        <td>
                            <b>{{item.TTL_NO_OF_BNDL_INSPECTED}}</b>
                            
                        </td>

                        <td>
                            <b>{{item.TTL_NO_OF_BNDL_STORE_RECV}}</b>
                            

                        </td>


                        <td>
                            <b> {{ item.TTL_NO_OF_BNDL_CUTTING -item.TTL_NO_OF_BNDL_STORE_RECV }}</b>

                           <span ng-if="(item.TTL_NO_OF_BNDL_CUTTING -item.TTL_NO_OF_BNDL_STORE_RECV) > 0" class="badge badge-important" style="cursor:pointer;margin-bottom:0px;" ng-click="vm.onMarkAsStore(item.GMT_BNDL_CRD_PDATA_LST)">MarkAsSoreRecv</span>

                        </td>
                        <td>
                            <b> {{item.TTL_NO_OF_BNDL_SCANNED}}</b>

                        </td>

                        <td>
                            <b> {{item.TTL_CUTTING_QTY_CUR}}</b>
                           
                        </td>
                        <td>
                            <b>{{item.TTL_SHORT_QTY}}</b>
                            
                        </td>
                        <td>
                            <b>{{item.TTL_FINAL_QTY}}</b>
                            
                        </td>
                    </tr>
                </tfoot>
            </table>
        </fieldset>
    </div>
</div>